# Death Rate Calculations

一個把「死亡率」資料、地理圖資與一個小巧 Win32 地圖示意程式放在同一個資料夾的專案。它不是大型框架，但很實用：你可以拿 Excel 做統計、用 GIS 軟體做地圖、再用 `simple_map` 這個極簡視覺化程式快速做展示。

**亮點**
- 有現成的死亡資料表（Excel）與大批量 Shapefile 圖層。
- 內建 Win32 GDI 範例程式，用矩形方塊快速展示縣市位置（示意圖，非真實地理）。
- 目錄結構清楚，資料、圖資、程式互不干擾。

**快速開始**
1. 直接執行 `simple_map\simple_map.exe` 開啟簡易縣市示意圖。
1. 需要真實地理邊界時，用 GIS 軟體（如 QGIS）打開 `shp` 內的 Shapefile。
1. 要做統計時，從 `全死因-按縣市別分.xlsx` 取得縣市別資料作分析。

**專案內容**
- `全死因-按縣市別分.xlsx`
  以「縣市別」為主軸的全死因資料表（依檔名判斷），可作為死亡率計算的基礎資料。
- `shp\`
  大量 Shapefile 圖層，含多種圖資分類與比例尺（如 25K），可用於製作地圖或疊加視覺化。
- `simple_map\`
  Win32 GDI 範例程式，快速繪製台灣縣市矩形示意圖。

**`simple_map` 功能摘要**
- 以 Win32 GDI 繪製矩形框，標示 22 個縣市名稱。
- 字型使用 `Microsoft JhengHei`，畫面清爽易讀。
- **注意**：這是示意圖，非真實地理位置與比例。

**資料與圖資說明**
- `shp\圖檔\` 下分為兩組資料夾（`94171NE`、`94171NW`），各自包含多類圖層與遮罩。

常見副檔名說明：

- `.shp` 幾何圖層
- `.dbf` 屬性表
- `.shx` 索引檔
- `.prj` 座標系統
- `.cpg` 字元編碼

**建置與編譯（可選）**
若要自行編譯 `simple_map`：

使用 MinGW：
```bash
gcc main.c -o simple_map.exe -lgdi32 -mwindows
```

使用 MSVC：
```bat
cl /DUNICODE /D_UNICODE /EHsc main.c user32.lib gdi32.lib
```

**實際分析流程（死亡率計算步驟）**
1. 開啟 `全死因-按縣市別分.xlsx`，確認欄位包含「縣市」與「死亡人數」等核心欄位。
1. 準備對應年份的「人口數」資料表（可另外匯入同一活頁或新增欄位）。
1. 依縣市對齊死亡人數與人口數，確保單位一致（人數為人、人口為人）。
1. 計算死亡率：`死亡率 = (死亡人數 / 人口數) × 100,000`（常用每十萬人）。
1. 檢查異常值（例如人口為 0 或死亡人數為空），並做必要的資料清理。
1. 輸出結果表（縣市、人口、死亡人數、死亡率），做排序或分級（例如分成 5 等級）。
1. Excel 視覺化：繪製條形圖或熱度表。
1. GIS 視覺化：將結果匯入 GIS，與 `shp` 圖資做欄位連結（Join）後製作分級設色地圖。

**適合的使用情境**
- 想用 Excel 做縣市死亡率計算並產出圖表
- 想把統計資料疊到 GIS 圖層上做空間分析
- 想快速做簡潔的「縣市分布示意」簡報圖

**備註**
- `simple_map` 是視覺化範例，不做實際地理投影或比例換算。
- Shapefile 屬性欄位與分類請以實際圖層內容為準。










